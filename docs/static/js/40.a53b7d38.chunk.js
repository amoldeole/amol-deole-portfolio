/*! For license information please see 40.a53b7d38.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkamol_deole_portfolio=self.webpackChunkamol_deole_portfolio||[]).push([[40],{1286:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},1884:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},2043:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},2574:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},3944:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},7118:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},9040:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var s=a(2555),r=a(5043),c=a(5487),n=a(3944),l=a(1286),o=a(9333),i=a(2043),d=a(2574),x=a(1884),h=a(9292),u=a(7118),m=a(9482),y=a(8564),g=a(9328),p=a(579);const f=e=>{let{compact:t=!1,onContactSelect:a,showActions:f=!0,maxHeight:b="h-full"}=e;const[j,v]=(0,r.useState)([]),[k,N]=(0,r.useState)(""),[w,A]=(0,r.useState)(!0),[C,S]=(0,r.useState)(null),[_,M]=(0,r.useState)(1),[z,L]=(0,r.useState)(!0),[F,T]=(0,r.useState)(null),{selectChat:E,loadChats:O}=(0,m.Y)(),U=g.y.getUser(),H=(0,r.useRef)(new Set),P=(0,r.useCallback)((async()=>{try{A(!0),S(null);const e={page:_.toString(),limit:t?"20":"10",role:"guest",sortBy:"createdAt",sortOrder:"desc"},a=new URLSearchParams;Object.entries(e).forEach((e=>{let[t,s]=e;a.append(t,s)})),k&&a.append("search",k);const r="?".concat(a.toString()),c=await fetch("".concat("https://portfolio-backend-ierw.onrender.com","/api/auth/users").concat(r),{method:"GET",headers:(0,s.A)({"Content-Type":"application/json"},g.y.getToken()&&{Authorization:"Bearer ".concat(g.y.getToken())})});if(!c.ok){if(401===c.status)throw g.y.logout(),new Error("Authentication failed. Please login again.");throw new Error("HTTP error! status: ".concat(c.status))}const n=await c.json();let l=[],o=null;if(n&&"object"===typeof n&&(n.success&&n.data?Array.isArray(n.data.users)?(l=n.data.users,o=n.data.pagination):Array.isArray(n.data)&&(l=n.data):Array.isArray(n.users)?(l=n.users,o=n.pagination):Array.isArray(n)&&(l=n)),!Array.isArray(l))throw console.error("Invalid users data received:",n),new Error("Invalid response format from server");const i=l.filter((e=>e&&"object"===typeof e&&e._id?e._id!==(null===U||void 0===U?void 0:U._id):(console.warn("Invalid user object:",e),!1))).map((e=>(0,s.A)((0,s.A)({},e),{},{isOnline:Math.random()>.5,unreadCount:Math.floor(3*Math.random())})));v(1===_?i:e=>[...e,...i]),L(o&&"object"===typeof o?!0===o.hasNext:i.length===(t?20:10))}catch(C){console.error("Failed to load contacts:",C),S(C instanceof Error?C.message:"Failed to load contacts")}finally{A(!1)}}),[_,k,null===U||void 0===U?void 0:U._id,t]),I=(0,r.useCallback)((async e=>{if(F!==e._id&&!H.current.has(e._id))if(a)a(e);else try{H.current.add(e._id),T(e._id),S(null);const t=await y.O.createIndividualChat(e._id);if(!t.success||!t.data)throw new Error(t.message||"Failed to create chat");await O(),E(t.data)}catch(C){console.error("Failed to start chat:",C),S(C instanceof Error?C.message:"Failed to start chat")}finally{T(null),H.current.delete(e._id)}}),[F,a,O,E]),q=(0,r.useCallback)((()=>{!w&&z&&M((e=>e+1))}),[w,z]),D=(0,r.useCallback)((e=>{if(!e)return"Never";try{const t=new Date,a=new Date(e),s=Math.floor((t.getTime()-a.getTime())/6e4);return s<1?"just now":s<60?"".concat(s,"m ago"):s<1440?"".concat(Math.floor(s/60),"h ago"):a.toLocaleDateString()}catch(C){return"Unknown"}}),[]);(0,r.useEffect)((()=>{P()}),[P]);const R=j.filter((e=>{if(!e||"object"!==typeof e)return!1;const t=String(e.firstName||""),a=String(e.lastName||""),s=String(e.email||""),r="".concat(t," ").concat(a).toLowerCase(),c=k.toLowerCase();return r.includes(c)||s.toLowerCase().includes(c)})),V=R.filter((e=>e.isFavorite)),B=R.filter((e=>!e.isFavorite)),G=r.memo((e=>{let{contact:a}=e;if(!a||"object"!==typeof a||!a._id)return null;const s=String(a.firstName||"Unknown"),r=String(a.lastName||"User"),x=String(a.email||"No email"),h="".concat(s," ").concat(r),u="".concat(s.charAt(0)).concat(r.charAt(0)).toUpperCase(),m=(e,t)=>{switch(e.stopPropagation(),t){case"call":case"video":break;case"chat":I(a)}};return(0,p.jsx)(c.P.div,{whileHover:{backgroundColor:"rgba(59, 130, 246, 0.05)"},className:"".concat(t?"p-3":"p-4"," hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer border-b border-gray-100 dark:border-gray-700"),onClick:()=>{I(a)},children:(0,p.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("div",{className:"".concat(t?"w-10 h-10":"w-12 h-12"," bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold ").concat(t?"text-sm":""),children:u}),a.isOnline&&(0,p.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900"}),a.isFavorite&&(0,p.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,p.jsx)(n.A,{size:t?8:10,className:"text-white fill-current"})})]}),(0,p.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between",children:[(0,p.jsx)("p",{className:"".concat("text-sm"," font-medium text-gray-900 dark:text-white truncate"),children:h}),(0,p.jsxs)("div",{className:"flex items-center space-x-1",children:[a.unreadCount&&a.unreadCount>0&&(0,p.jsx)("span",{className:"bg-blue-600 text-white text-xs rounded-full px-2 py-1 min-w-[16px] text-center",children:a.unreadCount?a.unreadCount:""}),f&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("button",{className:"p-1 text-gray-400 hover:text-green-600 rounded transition-colors",title:"Voice Call",onClick:e=>m(e,"call"),children:(0,p.jsx)(l.A,{size:t?14:16})}),(0,p.jsx)("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded transition-colors",title:"Video Call",onClick:e=>m(e,"video"),children:(0,p.jsx)(o.A,{size:t?14:16})})]}),(0,p.jsx)("button",{onClick:e=>m(e,"chat"),disabled:F===a._id,className:"p-1 text-gray-400 hover:text-blue-600 rounded transition-colors disabled:opacity-50",title:"Start Chat",children:F===a._id?(0,p.jsx)(i.A,{size:t?14:16,className:"animate-spin"}):(0,p.jsx)(d.A,{size:t?14:16})})]})]}),!t&&(0,p.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:x}),(0,p.jsx)("p",{className:"".concat("text-xs"," text-gray-400"),children:a.isOnline?(0,p.jsx)("span",{className:"text-green-600",children:"Online"}):"Last seen ".concat(D(a.lastSeen))})]})]})})}));return(0,p.jsxs)("div",{className:"".concat(b," flex flex-col bg-white dark:bg-gray-900"),children:[!t&&(0,p.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Contacts"}),(0,p.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,p.jsx)(x.A,{size:20})})]}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),(0,p.jsx)("input",{type:"text",placeholder:"Search contacts...",value:k,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-800 border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"})]})]}),C&&(0,p.jsxs)("div",{className:"".concat(t?"p-3":"p-4"," bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500"),children:[(0,p.jsx)("p",{className:"".concat(t?"text-xs":"text-sm"," text-red-700 dark:text-red-400"),children:C}),(0,p.jsx)("button",{onClick:()=>{S(null),M(1),P()},className:"".concat(t?"text-xs":"text-sm"," text-red-600 dark:text-red-400 hover:underline mt-1"),children:"Try again"})]}),(0,p.jsx)("div",{className:"flex-1 overflow-y-auto",children:w&&1===_?(0,p.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full ".concat(t?"h-6 w-6":"h-8 w-8"," border-b-2 border-blue-600 mx-auto mb-2")}),(0,p.jsx)("p",{className:"".concat(t?"text-xs":"text-sm"," text-gray-500"),children:"Loading contacts..."})]})}):(0,p.jsxs)(p.Fragment,{children:[V.length>0&&(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"".concat(t?"px-3 py-1":"px-4 py-2"," bg-gray-50 dark:bg-gray-800"),children:(0,p.jsxs)("h3",{className:"".concat(t?"text-xs":"text-sm"," font-medium text-gray-700 dark:text-gray-300 flex items-center"),children:[(0,p.jsx)(n.A,{size:t?12:16,className:"mr-2 text-yellow-500"}),"Favorites (",V.length,")"]})}),V.map((e=>(0,p.jsx)(G,{contact:e},e._id)))]}),B.length>0&&(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"".concat(t?"px-3 py-1":"px-4 py-2"," bg-gray-50 dark:bg-gray-800"),children:(0,p.jsxs)("h3",{className:"".concat(t?"text-xs":"text-sm"," font-medium text-gray-700 dark:text-gray-300 flex items-center"),children:[(0,p.jsx)(u.A,{size:t?12:16,className:"mr-2"}),"All Contacts (",B.length,")"]})}),B.map((e=>(0,p.jsx)(G,{contact:e},e._id)))]}),z&&!w&&B.length>0&&!t&&(0,p.jsx)("div",{className:"p-4",children:(0,p.jsx)("button",{onClick:q,className:"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Load More Contacts"})}),w&&_>1&&(0,p.jsxs)("div",{className:"flex items-center justify-center ".concat(t?"p-3":"p-4"),children:[(0,p.jsx)("div",{className:"animate-spin rounded-full ".concat(t?"h-4 w-4":"h-6 w-6"," border-b-2 border-blue-600")}),(0,p.jsx)("span",{className:"ml-2 ".concat(t?"text-xs":"text-sm"," text-gray-500"),children:"Loading more..."})]}),0===R.length&&!w&&!C&&(0,p.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)(u.A,{size:t?32:48,className:"mx-auto mb-4 opacity-50"}),(0,p.jsx)("p",{className:"font-medium ".concat(t?"text-sm":""),children:"No contacts found"}),(0,p.jsx)("p",{className:"".concat(t?"text-xs":"text-sm"),children:k?"Try adjusting your search terms":"No users available to connect with"}),!k&&(0,p.jsx)("button",{onClick:()=>{M(1),P()},className:"mt-2 text-blue-600 hover:text-blue-800 ".concat(t?"text-xs":"text-sm"),children:"Refresh contacts"})]})})]})})]})}},9292:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},9333:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])}}]);
//# sourceMappingURL=40.a53b7d38.chunk.js.map