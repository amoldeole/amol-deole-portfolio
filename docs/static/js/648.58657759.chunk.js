"use strict";(self.webpackChunkamol_deole_portfolio=self.webpackChunkamol_deole_portfolio||[]).push([[648],{1204:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var s=a(5043),r=a(5487),i=a(8326),l=a(4459),n=a(8393),d=a(7940),c=a(9233),o=a(3677),x=a(5699),g=a(5087),u=a(4651),h=a(5731),m=a(2489),y=a(6963),b=a(7673),p=a(7666),v=a(8321),f=a(579);const j=()=>{const{theme:e,toggleTheme:t}=(0,v.D)(),[a,j]=(0,s.useState)(!0),[N,w]=(0,s.useState)(!0),[k,C]=(0,s.useState)(!0),[A,_]=(0,s.useState)(!0),z=e=>{let{icon:t,title:a,subtitle:s,action:l,onClick:n}=e;return(0,f.jsx)(r.P.div,{whileHover:{backgroundColor:"rgba(59, 130, 246, 0.05)"},onClick:n,className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer",children:(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsx)("div",{className:"w-10 h-10 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-300",children:t}),(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a}),s&&(0,f.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s})]}),l||(0,f.jsx)(i.A,{size:20,className:"text-gray-400"})]})})},S=e=>{let{enabled:t,onChange:a}=e;return(0,f.jsx)("button",{onClick:()=>a(!t),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(t?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"),children:(0,f.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(t?"translate-x-6":"translate-x-1")})})};return(0,f.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[(0,f.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,f.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Settings"})}),(0,f.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,f.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,f.jsx)(z,{icon:(0,f.jsx)(l.A,{size:20}),title:"Profile",subtitle:"Update your profile information"})}),(0,f.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,f.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Appearance"})}),(0,f.jsx)(z,{icon:"dark"===e?(0,f.jsx)(n.A,{size:20}):(0,f.jsx)(d.A,{size:20}),title:"Theme",subtitle:"Currently using ".concat(e," mode"),action:(0,f.jsx)("button",{onClick:t,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:"dark"===e?"Light":"Dark"})})]}),(0,f.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,f.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Notifications"})}),(0,f.jsx)(z,{icon:(0,f.jsx)(c.A,{size:20}),title:"Push Notifications",subtitle:"Receive notifications for new messages",action:(0,f.jsx)(S,{enabled:a,onChange:j})}),(0,f.jsx)(z,{icon:N?(0,f.jsx)(o.A,{size:20}):(0,f.jsx)(x.A,{size:20}),title:"Notification Sounds",subtitle:"Play sounds for notifications",action:(0,f.jsx)(S,{enabled:N,onChange:w})})]}),(0,f.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,f.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Privacy"})}),(0,f.jsx)(z,{icon:k?(0,f.jsx)(g.A,{size:20}):(0,f.jsx)(u.A,{size:20}),title:"Read Receipts",subtitle:"Let others know when you've read their messages",action:(0,f.jsx)(S,{enabled:k,onChange:C})}),(0,f.jsx)(z,{icon:(0,f.jsx)(h.A,{size:20}),title:"Last Seen",subtitle:"Show when you were last online",action:(0,f.jsx)(S,{enabled:A,onChange:_})}),(0,f.jsx)(z,{icon:(0,f.jsx)(m.A,{size:20}),title:"Blocked Contacts",subtitle:"Manage blocked users"})]}),(0,f.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,f.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,f.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Chat"})}),(0,f.jsx)(z,{icon:(0,f.jsx)(y.A,{size:20}),title:"Chat Backup",subtitle:"Backup and restore your chats"}),(0,f.jsx)(z,{icon:(0,f.jsx)(b.A,{size:20}),title:"Chat Wallpaper",subtitle:"Customize your chat background"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,f.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Support"})}),(0,f.jsx)(z,{icon:(0,f.jsx)(p.A,{size:20}),title:"Help & Support",subtitle:"Get help and contact support"})]})]})]})}},3494:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var s=a(5043),r=a(5487),i=a(1360),l=a(5686),n=a(5087),d=a(247),c=a(2300),o=a(5088),x=a(579);const g=()=>{const[e,t]=(0,s.useState)([]),[a,g]=(0,s.useState)([]),[u,h]=(0,s.useState)(!0);(0,s.useEffect)((()=>{setTimeout((()=>{g([{id:"1",user:{id:"me",name:"My Status",avatar:"ME"},content:{type:"text",data:"Working on something amazing! \ud83d\ude80",backgroundColor:"#3B82F6"},timestamp:new Date(Date.now()-18e5),views:5,isViewed:!0}]),t([{id:"2",user:{id:"1",name:"John Doe",avatar:"JD"},content:{type:"text",data:"Beautiful sunset today! \ud83c\udf05",backgroundColor:"#F59E0B"},timestamp:new Date(Date.now()-72e5),views:12,isViewed:!1},{id:"3",user:{id:"2",name:"Jane Smith",avatar:"JS"},content:{type:"text",data:"Coffee time! \u2615",backgroundColor:"#8B5CF6"},timestamp:new Date(Date.now()-144e5),views:8,isViewed:!0}]),h(!1)}),1e3)}),[]);const m=e=>{const t=new Date,a=Math.floor((t.getTime()-e.getTime())/36e5);return a<1?"just now":a<24?"".concat(a,"h ago"):e.toLocaleDateString()},y=e=>{let{status:t,isOwn:a=!1}=e;return(0,x.jsx)(r.P.div,{whileHover:{backgroundColor:"rgba(59, 130, 246, 0.05)"},className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer",children:(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsxs)("div",{className:"relative",children:[(0,x.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold border-2 ".concat(t.isViewed?"border-gray-300":"border-green-500"),style:{backgroundColor:t.content.backgroundColor||"#6B7280"},children:t.user.avatar}),a&&(0,x.jsx)("div",{className:"absolute bottom-0 right-0 w-4 h-4 bg-blue-600 rounded-full flex items-center justify-center",children:(0,x.jsx)(i.A,{size:10,className:"text-white"})})]}),(0,x.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between",children:[(0,x.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.user.name}),(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:m(t.timestamp)}),a&&(0,x.jsx)("button",{className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:(0,x.jsx)(l.A,{size:16})})]})]}),(0,x.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:"text"===t.content.type?t.content.data:"".concat(t.content.type," status")}),a&&(0,x.jsxs)("div",{className:"flex items-center mt-1",children:[(0,x.jsx)(n.A,{size:12,className:"text-gray-400 mr-1"}),(0,x.jsxs)("span",{className:"text-xs text-gray-400",children:[t.views," views"]})]})]})]})})};return(0,x.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[(0,x.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Status"}),(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,x.jsx)(d.A,{size:20})}),(0,x.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,x.jsx)(c.A,{size:20})})]})]})}),(0,x.jsx)("div",{className:"flex-1 overflow-y-auto",children:u?(0,x.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,x.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,x.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"My Status"})}),a.length>0?a.map((e=>(0,x.jsx)(y,{status:e,isOwn:!0},e.id))):(0,x.jsx)("div",{className:"p-4",children:(0,x.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,x.jsx)("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center",children:(0,x.jsx)(i.A,{size:24,className:"text-gray-400"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"My Status"}),(0,x.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tap to add status update"})]})]})})]}),e.length>0&&(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,x.jsx)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Recent Updates"})}),e.map((e=>(0,x.jsx)(y,{status:e},e.id)))]}),0===e.length&&0===a.length&&!u&&(0,x.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)(o.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,x.jsx)("p",{className:"font-medium",children:"No status updates"}),(0,x.jsx)("p",{className:"text-sm",children:"Share your status to let contacts know what's on your mind"})]})})]})})]})}},3648:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var s=a(5043),r=a(5487),i=a(1884),l=a(9292),n=a(2574),d=a(1286),c=a(9333),o=a(5746),x=a(7118),g=a(5088),u=a(7365),h=a(1045),m=a(9040),y=a(3494),b=a(1204),p=a(9328),v=a(6338),f=a(7822),j=a(9482),N=a(579);const w=()=>{const{state:e,selectChat:t}=(0,j.Y)(),[a,d]=(0,s.useState)(""),c=p.y.getUser(),o=e=>{if("group"===e.type)return e.groupName||"Group Chat";const t=e.participants.find((e=>e._id!==(null===c||void 0===c?void 0:c._id)));return t?"".concat(t.firstName," ").concat(t.lastName):"Unknown"},x=e=>{var t;if("group"===e.type)return(null===(t=e.groupName)||void 0===t?void 0:t.charAt(0).toUpperCase())||"G";const a=e.participants.find((e=>e._id!==(null===c||void 0===c?void 0:c._id)));return a?"".concat(a.firstName.charAt(0)).concat(a.lastName.charAt(0)).toUpperCase():"U"},g=e=>{if("group"===e.type)return!1;const t=e.participants.find((e=>e._id!==(null===c||void 0===c?void 0:c._id)));return(null===t||void 0===t?void 0:t.isOnline)||!1},u=e=>{const t=new Date(e),a=new Date,s=Math.floor((a.getTime()-t.getTime())/864e5);return 0===s?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):1===s?"Yesterday":s<7?t.toLocaleDateString([],{weekday:"short"}):t.toLocaleDateString([],{month:"short",day:"numeric"})},h=e.chats.filter((e=>o(e).toLowerCase().includes(a.toLowerCase())));return(0,N.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[(0,N.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,N.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Chats"}),(0,N.jsx)("div",{className:"flex items-center space-x-2",children:(0,N.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,N.jsx)(i.A,{size:20})})})]}),(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)(l.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),(0,N.jsx)("input",{type:"text",placeholder:"Search or start new chat",value:a,onChange:e=>d(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-800 border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"})]})]}),(0,N.jsx)("div",{className:"flex-1 overflow-y-auto",children:e.loading?(0,N.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,N.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===h.length?(0,N.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)(n.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,N.jsx)("p",{className:"font-medium",children:"No chats yet"}),(0,N.jsx)("p",{className:"text-sm",children:"Go to Contacts to start a conversation"})]})}):h.map((a=>{var s,i;return(0,N.jsx)(r.P.div,{whileHover:{backgroundColor:"rgba(59, 130, 246, 0.05)"},onClick:()=>t(a),className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-800 ".concat((null===(s=e.selectedChat)||void 0===s?void 0:s._id)===a._id?"bg-blue-50 dark:bg-blue-900/20":""),children:(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-lg",children:x(a)}),g(a)&&(0,N.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900"})]}),(0,N.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:o(a)}),a.lastMessage&&(0,N.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:u(a.lastMessage.createdAt)})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,N.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:(null===(i=a.lastMessage)||void 0===i?void 0:i.content)||"No messages yet"}),a.unreadCount>0&&(0,N.jsx)("div",{className:"bg-blue-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center ml-2",children:a.unreadCount>99?"99+":a.unreadCount})]})]})]})},a._id)}))})]})},k=()=>{const{state:e,sendMessage:t}=(0,j.Y)(),[a,i]=(0,s.useState)(""),l=p.y.getUser();if(!e.selectedChat)return(0,N.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,N.jsxs)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[(0,N.jsx)(n.A,{size:64,className:"mx-auto mb-4 opacity-50"}),(0,N.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Welcome to Chat"}),(0,N.jsx)("p",{children:"Select a conversation from the sidebar to start messaging"}),(0,N.jsx)("p",{className:"text-sm mt-2",children:"Or go to Contacts to start a new conversation"})]})});const x=async()=>{if(a.trim()&&e.selectedChat)try{await t(e.selectedChat._id,a.trim()),i("")}catch(s){console.error("Failed to send message:",s)}};return(0,N.jsxs)("div",{className:"flex-1 flex flex-col bg-white dark:bg-gray-800",children:[(0,N.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:"group"===e.selectedChat.type?(e.selectedChat.groupName||"G").charAt(0).toUpperCase():"U"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:(e=>{if("group"===e.type)return e.groupName||"Group Chat";const t=e.participants.find((e=>e._id!==(null===l||void 0===l?void 0:l._id)));return t?"".concat(t.firstName," ").concat(t.lastName):"Unknown"})(e.selectedChat)}),(0,N.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:(e=>{if("group"===e.type)return!1;const t=e.participants.find((e=>e._id!==(null===l||void 0===l?void 0:l._id)));return(null===t||void 0===t?void 0:t.isOnline)||!1})(e.selectedChat)?"Online":"Last seen recently"})]})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,N.jsx)(d.A,{size:20})}),(0,N.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,N.jsx)(c.A,{size:20})})]})]})}),(0,N.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900 chat-background",children:e.messages.map((e=>{const t=e.sender._id===(null===l||void 0===l?void 0:l._id);return(0,N.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex ".concat(t?"justify-end":"justify-start"),children:(0,N.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg shadow-sm ".concat(t?"bg-blue-600 text-white rounded-br-sm":"bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-bl-sm"),children:[e.replyTo&&(0,N.jsxs)("div",{className:"mb-2 p-2 bg-black bg-opacity-10 rounded text-xs",children:[(0,N.jsx)("p",{className:"font-medium opacity-80",children:e.replyTo.sender.firstName}),(0,N.jsx)("p",{className:"truncate opacity-75",children:e.replyTo.content})]}),(0,N.jsx)("p",{className:"text-sm",children:e.content}),(0,N.jsxs)("div",{className:"flex items-center justify-end mt-1 space-x-1",children:[(0,N.jsx)("span",{className:"text-xs opacity-70",children:(a=e.createdAt,new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}),t&&(0,N.jsx)("div",{className:"text-xs opacity-70",children:"\u2713\u2713"})]})]})},e._id);var a}))}),(0,N.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("input",{type:"text",value:a,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&x(),placeholder:"Type a message...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"}),(0,N.jsx)("button",{onClick:x,disabled:!a.trim(),className:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,N.jsx)(o.A,{size:20})})]})})]})},C=()=>{const[e,t]=(0,s.useState)("chats"),a=[{id:"chats",label:"Chats",icon:n.A},{id:"contacts",label:"Contacts",icon:x.A},{id:"status",label:"Status",icon:g.A},{id:"settings",label:"Settings",icon:u.A}];return(0,N.jsx)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900",children:(0,N.jsx)("div",{className:"mx-auto",children:(0,N.jsxs)("div",{className:"flex h-screen",children:[(0,N.jsx)("div",{className:"w-16 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col items-center py-4",children:a.map((a=>{const s=a.icon;return(0,N.jsx)("button",{onClick:()=>t(a.id),className:"p-3 rounded-lg mb-2 transition-colors ".concat(e===a.id?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),title:a.label,children:(0,N.jsx)(s,{size:24})},a.id)}))}),(0,N.jsx)("div",{className:"flex-1 bg-white dark:bg-gray-800",children:(0,N.jsxs)(h.BV,{children:[(0,N.jsx)(h.qh,{path:"/chat-widget1",element:(0,N.jsx)(v.default,{})}),(0,N.jsx)(h.qh,{path:"/chat-widget2",element:(0,N.jsx)(f.default,{})}),(0,N.jsx)(h.qh,{path:"*",element:(()=>{switch(e){case"chats":return(0,N.jsxs)("div",{className:"flex h-full",children:[(0,N.jsx)("div",{className:"w-1/3 border-r border-gray-200 dark:border-gray-700",children:(0,N.jsx)(w,{})}),(0,N.jsx)(k,{})]});case"contacts":return(0,N.jsx)(m.default,{});case"status":return(0,N.jsx)(y.default,{});case"settings":return(0,N.jsx)(b.default,{});default:return(0,N.jsx)(w,{})}})()})]})})]})})})}},6338:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var s=a(5043),r=a(5487),i=a(3546),l=a(3771),n=a(6210),d=a(2574),c=a(5469),o=a(1286),x=a(9333),g=a(5686),u=a(614),h=a(9292),m=a(5010),y=a(2494),b=a(7922),p=a(5746),v=a(1824),f=a(9482),j=a(9328),N=a(579);const w=()=>{var e;const{state:t,loadChats:a,selectChat:w,sendMessage:k,sendTyping:C}=(0,f.Y)(),[A,_]=(0,s.useState)(null),{initiateCall:z}=(0,v.G)(),[S,T]=(0,s.useState)(!1),[E,D]=(0,s.useState)(""),[U,M]=(0,s.useState)(""),[L,P]=(0,s.useState)(null),[F,B]=(0,s.useState)(!1),O=(0,s.useRef)(null),I=(0,s.useRef)();(0,s.useEffect)((()=>{S&&j.y.isAuthenticated()&&a()}),[S,a]),(0,s.useEffect)((()=>{H()}),[t.messages]),(0,s.useEffect)((()=>(t.selectedChat&&F&&(C(t.selectedChat._id,!0),I.current&&clearTimeout(I.current),I.current=setTimeout((()=>{B(!1),C(t.selectedChat._id,!1)}),1e3)),()=>{I.current&&clearTimeout(I.current)})),[F,t.selectedChat,C]);const H=()=>{var e;null===(e=O.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},R=async()=>{if(E.trim()&&t.selectedChat)try{await k(t.selectedChat._id,E.trim(),void 0,null===L||void 0===L?void 0:L._id),D(""),P(null),B(!1),I.current&&(clearTimeout(I.current),C(t.selectedChat._id,!1))}catch(e){console.error("Failed to send message:",e)}},V=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),G=e=>{if("group"===e.type)return e.groupName||"Group Chat";const t=j.y.getUser(),a=e.participants.find((e=>e._id!==(null===t||void 0===t?void 0:t._id)));return a?"".concat(a.firstName," ").concat(a.lastName):"Unknown"},W=e=>{var t;if("group"===e.type)return(null===(t=e.groupName)||void 0===t?void 0:t.charAt(0).toUpperCase())||"G";const a=j.y.getUser(),s=e.participants.find((e=>e._id!==(null===a||void 0===a?void 0:a._id)));return s?"".concat(s.firstName.charAt(0)).concat(s.lastName.charAt(0)).toUpperCase():"U"},Y=e=>{if("group"===e.type)return!1;const t=j.y.getUser(),a=e.participants.find((e=>e._id!==(null===t||void 0===t?void 0:t._id)));return(null===a||void 0===a?void 0:a.isOnline)||!1},J=e=>{const t=j.y.getUser();return e.sender._id!==(null===t||void 0===t?void 0:t._id)?null:e.readBy&&e.readBy.length>0?(0,N.jsx)(l.A,{className:"w-3 h-3 text-blue-400"}):e.deliveredTo&&e.deliveredTo.length>0?(0,N.jsx)(l.A,{className:"w-3 h-3 text-gray-400"}):(0,N.jsx)(n.A,{className:"w-3 h-3 text-gray-400"})},q=t.chats.filter((e=>G(e).toLowerCase().includes(U.toLowerCase()))),K=j.y.getUser(),Z=t.selectedChat&&t.typingUsers.get(t.selectedChat._id)||[];return j.y.isAuthenticated()?(0,N.jsxs)("div",{className:"fixed bottom-4 right-4 z-50",children:[(0,N.jsx)(i.N,{children:!S&&(0,N.jsxs)(r.P.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>T(!0),className:"bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg relative",children:[(0,N.jsx)(d.A,{size:24}),t.unreadCount>0&&(0,N.jsx)("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center",children:t.unreadCount>99?"99+":t.unreadCount})]})}),(0,N.jsx)(i.N,{children:S&&(0,N.jsxs)(r.P.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-96 h-[600px] flex flex-col overflow-hidden border border-gray-200 dark:border-gray-700",children:[(0,N.jsxs)("div",{className:"bg-green-600 dark:bg-green-700 text-white p-4 flex items-center justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[t.selectedChat&&(0,N.jsx)("button",{onClick:()=>_(null),className:"p-1 hover:bg-green-700 dark:hover:bg-green-600 rounded",children:(0,N.jsx)(c.A,{size:20})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"font-semibold",children:t.selectedChat?G(t.selectedChat):"WhatsApp"}),t.selectedChat&&(0,N.jsx)("p",{className:"text-xs text-green-100",children:Y(t.selectedChat)?"online":null!==(e=t.selectedChat.participants.find((e=>e._id!==(null===K||void 0===K?void 0:K._id))))&&void 0!==e&&e.lastSeen?"last seen ".concat((e=>{const t=new Date,a=new Date(e),s=Math.floor((t.getTime()-a.getTime())/6e4);return s<1?"just now":s<60?"".concat(s,"m ago"):s<1440?"".concat(Math.floor(s/60),"h ago"):a.toLocaleDateString()})(t.selectedChat.participants.find((e=>e._id!==(null===K||void 0===K?void 0:K._id))).lastSeen)):"offline"})]})]}),(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[t.selectedChat&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{onClick:()=>{if(t.selectedChat){const e=j.y.getUser(),a=t.selectedChat.participants.filter((t=>t._id!==(null===e||void 0===e?void 0:e._id)));z(a,"voice",t.selectedChat._id)}},className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",title:"Voice Call",children:(0,N.jsx)(o.A,{size:18})}),(0,N.jsx)("button",{onClick:()=>{if(t.selectedChat){const e=j.y.getUser(),a=t.selectedChat.participants.filter((t=>t._id!==(null===e||void 0===e?void 0:e._id)));z(a,"video",t.selectedChat._id)}},className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",title:"Video Call",children:(0,N.jsx)(x.A,{size:18})}),(0,N.jsx)("button",{className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",children:(0,N.jsx)(g.A,{size:18})})]}),(0,N.jsx)("button",{onClick:()=>T(!1),className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",children:(0,N.jsx)(u.A,{size:18})})]})]}),!t.isConnected&&(0,N.jsx)("div",{className:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-4 py-2 text-sm text-center",children:"Connecting..."}),(0,N.jsx)("div",{className:"flex-1 overflow-hidden",children:t.selectedChat?(0,N.jsxs)("div",{className:"h-full flex flex-col",children:[(0,N.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 chat-messages",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23e5ddd5' fill-opacity='0.4'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")",backgroundColor:"#e5ddd5"},"data-messages-container":!0,children:[t.messages.map((e=>{const t=e.sender._id===(null===K||void 0===K?void 0:K._id);return(0,N.jsx)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex ".concat(t?"justify-end":"justify-start"," group"),children:(0,N.jsxs)("div",{className:"max-w-xs px-3 py-2 rounded-lg shadow-sm relative ".concat(t?"bg-green-500 text-white":"bg-white text-gray-900"),style:{borderRadius:t?"7.5px 7.5px 7.5px 0px":"7.5px 7.5px 0px 7.5px"},children:[e.replyTo&&(0,N.jsxs)("div",{className:"mb-2 p-2 rounded border-l-4 text-xs ".concat(t?"bg-green-600 border-green-300":"bg-gray-100 border-gray-400"),children:[(0,N.jsx)("p",{className:"font-medium opacity-80",children:e.replyTo.sender.firstName}),(0,N.jsx)("p",{className:"truncate opacity-70",children:e.replyTo.content})]}),e.content&&(0,N.jsx)("p",{className:"text-sm leading-relaxed",children:e.content}),(0,N.jsxs)("div",{className:"flex items-center justify-end mt-1 space-x-1",children:[(0,N.jsx)("span",{className:"text-xs ".concat(t?"text-green-100":"text-gray-500"),children:V(e.createdAt)}),t&&(0,N.jsx)("div",{className:"text-green-100",children:J(e)})]}),!t&&(0,N.jsx)("button",{onClick:()=>P(e),className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 p-1 bg-gray-200 hover:bg-gray-300 rounded transition-opacity",children:(0,N.jsx)(m.A,{size:12})})]})},e._id)})),Z.length>0&&(0,N.jsx)("div",{className:"flex justify-start",children:(0,N.jsx)("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:(0,N.jsxs)("div",{className:"flex space-x-1",children:[(0,N.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,N.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,N.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),(0,N.jsx)("div",{ref:O})]}),L&&(0,N.jsx)("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 border-l-4 border-green-500",children:(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("p",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:["Replying to ",L.sender.firstName]}),(0,N.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",children:L.content})]}),(0,N.jsx)("button",{onClick:()=>P(null),className:"text-gray-400 hover:text-gray-600",children:(0,N.jsx)(u.A,{size:16})})]})}),(0,N.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900",children:(0,N.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,N.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,N.jsx)(y.A,{size:20})}),(0,N.jsx)("div",{className:"flex-1 relative",children:(0,N.jsx)("input",{type:"text",value:E,onChange:e=>{D(e.target.value),!F&&e.target.value.trim()?B(!0):F&&!e.target.value.trim()&&B(!1)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),R())},placeholder:"Type a message",className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 dark:text-white"})}),(0,N.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,N.jsx)(b.A,{size:20})}),(0,N.jsx)("button",{onClick:R,disabled:!E.trim(),className:"p-2 bg-green-500 text-white rounded-full hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,N.jsx)(p.A,{size:18})})]})})]}):(0,N.jsxs)("div",{className:"h-full flex flex-col",children:[(0,N.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900",children:(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,N.jsx)("input",{type:"text",placeholder:"Search or start new chat",value:U,onChange:e=>M(e.target.value),className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 dark:text-white"})]})}),(0,N.jsx)("div",{className:"flex-1 overflow-y-auto",children:t.loading?(0,N.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,N.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):0===q.length?(0,N.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,N.jsxs)("div",{className:"text-center",children:[(0,N.jsx)(d.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,N.jsx)("p",{children:"No conversations yet"}),(0,N.jsx)("p",{className:"text-sm",children:"Tap the new chat button to start messaging"})]})}):q.map((e=>{var t;return(0,N.jsx)(r.P.div,{whileHover:{backgroundColor:"rgba(0, 0, 0, 0.05)"},onClick:()=>_(e),className:"p-3 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700",children:(0,N.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,N.jsxs)("div",{className:"relative",children:[(0,N.jsx)("div",{className:"w-12 h-12 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center text-gray-700 dark:text-gray-300 font-semibold",children:W(e)}),Y(e)&&(0,N.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"})]}),(0,N.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:G(e)}),e.lastMessage&&(0,N.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:V(e.lastMessage.createdAt)})]}),(0,N.jsxs)("div",{className:"flex items-center justify-between",children:[(0,N.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:(null===(t=e.lastMessage)||void 0===t?void 0:t.content)||"Tap to start messaging"}),e.unreadCount>0&&(0,N.jsx)("div",{className:"bg-green-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:e.unreadCount>99?"99+":e.unreadCount})]})]})]})},e._id)}))})]})})]})})]}):(0,N.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,N.jsx)(r.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>T(!0),className:"bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg",children:(0,N.jsx)(d.A,{size:24})})})}},7822:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var s=a(2555),r=a(5043),i=a(5487),l=a(3546),n=a(3771),d=a(6210),c=a(2574),o=a(5469),x=a(1286),g=a(9333),u=a(614),h=a(9292),m=a(2494),y=a(5010),b=a(7922),p=a(5746),v=a(8564),f=a(9328),j=a(2996),N=a(1045),w=a(579);const k=()=>{var e;const[t,a]=(0,r.useState)(!1),[k,C]=(0,r.useState)(!1),[A,_]=(0,r.useState)([]),[z,S]=(0,r.useState)(null),[T,E]=(0,r.useState)([]),[D,U]=(0,r.useState)(""),[M,L]=(0,r.useState)(""),[P,F]=(0,r.useState)(!1),[B,O]=(0,r.useState)(null),[I,H]=(0,r.useState)(!1),[R,V]=(0,r.useState)(!1),G=(0,r.useRef)(null),W=(0,r.useRef)(),Y=f.y.getUser(),J=(0,N.Zp)();(0,r.useEffect)((()=>{C(f.y.isAuthenticated())}),[]),(0,r.useEffect)((()=>{k&&q()}),[k]),(0,r.useEffect)((()=>{z&&K(z._id)}),[z]),(0,r.useEffect)((()=>{var e;null===(e=G.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[T]),(0,r.useEffect)((()=>(z&&I&&(W.current&&clearTimeout(W.current),W.current=setTimeout((()=>{H(!1),j.z.sendTyping(z._id,!1)}),1e3)),()=>{W.current&&clearTimeout(W.current)})),[I,z]),(0,r.useEffect)((()=>{const e=e=>{z&&e.chatId===z._id&&e.userId!==(null===Y||void 0===Y?void 0:Y._id)&&V(e.isTyping)},t=e=>{console.log("New message received:",e),z&&e.chatId===z._id&&E((t=>[...t,e])),_((t=>t.map((t=>t._id===e.chatId?(0,s.A)((0,s.A)({},t),{},{unreadCount:(t.unreadCount||0)+1,lastMessage:e}):t)))),z&&e.chatId===z._id||window.dispatchEvent(new CustomEvent("toast",{detail:{type:"notification",message:"New message from ".concat(e.sender.firstName,": ").concat(e.content)}}))};return j.z.on("userTyping",e),j.z.on("newMessage",t),()=>{j.z.off("userTyping",e),j.z.off("newMessage",t)}}),[z,Y]);const q=async()=>{try{var e,t;F(!0);const a=await v.O.getUserChats(),s=(null===(e=a.data)||void 0===e?void 0:e.chats)||(null===(t=a.data)||void 0===t?void 0:t.items)||[];_(s)}catch(a){console.error("Failed to load chats:",a)}finally{F(!1)}},K=async e=>{try{var t,a;F(!0);const s=await v.O.getChatMessages(e),r=(null===(t=s.data)||void 0===t?void 0:t.messages)||(null===(a=s.data)||void 0===a?void 0:a.items)||[];E(r)}catch(s){console.error("Failed to load messages:",s)}finally{F(!1)}},Z=async()=>{if(D.trim()&&z)try{j.z.sendMessage({chatId:z._id,content:D.trim(),replyTo:null===B||void 0===B?void 0:B._id}),U(""),O(null),H(!1),j.z.sendTyping(z._id,!1)}catch(e){console.error("Failed to send message:",e)}},Q=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),X=e=>{if("group"===e.type)return e.groupName||"Group Chat";const t=e.participants.find((e=>e._id!==(null===Y||void 0===Y?void 0:Y._id)));return t?"".concat(t.firstName," ").concat(t.lastName):"Unknown"},$=e=>{var t;if("group"===e.type)return(null===(t=e.groupName)||void 0===t?void 0:t.charAt(0).toUpperCase())||"G";const a=e.participants.find((e=>e._id!==(null===Y||void 0===Y?void 0:Y._id)));return a?"".concat(a.firstName.charAt(0)).concat(a.lastName.charAt(0)).toUpperCase():"U"},ee=e=>{if("group"===e.type)return!1;const t=e.participants.find((e=>e._id!==(null===Y||void 0===Y?void 0:Y._id)));return(null===t||void 0===t?void 0:t.isOnline)||!1},te=e=>e.sender._id!==(null===Y||void 0===Y?void 0:Y._id)?null:e.readBy&&e.readBy.length>0?(0,w.jsx)(n.A,{className:"w-3 h-3 text-blue-400"}):e.deliveredTo&&e.deliveredTo.length>0?(0,w.jsx)(n.A,{className:"w-3 h-3 text-gray-400"}):(0,w.jsx)(d.A,{className:"w-3 h-3 text-gray-400"}),ae=A.filter((e=>X(e).toLowerCase().includes(M.toLowerCase())));return k?(0,w.jsxs)("div",{className:"fixed bottom-4 right-4 z-50",children:[(0,w.jsx)(l.N,{children:!t&&(0,w.jsxs)(i.P.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>{k?a(!0):J("/signup")},className:"bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg relative",children:[(0,w.jsx)(c.A,{size:24}),A.reduce(((e,t)=>e+(t.unreadCount||0)),0)>0&&(0,w.jsx)("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center",children:A.reduce(((e,t)=>e+(t.unreadCount||0)),0)>99?"99+":A.reduce(((e,t)=>e+(t.unreadCount||0)),0)})]})}),(0,w.jsx)(l.N,{children:t&&(0,w.jsxs)(i.P.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-96 h-[600px] flex flex-col overflow-hidden border border-gray-200 dark:border-gray-700",children:[(0,w.jsxs)("div",{className:"bg-green-600 dark:bg-green-700 text-white p-4 flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[z&&(0,w.jsx)("button",{onClick:()=>S(null),className:"p-1 hover:bg-green-700 dark:hover:bg-green-600 rounded",children:(0,w.jsx)(o.A,{size:20})}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{className:"font-semibold",children:z?X(z):"WhatsApp"}),z&&(0,w.jsx)("p",{className:"text-xs text-green-100",children:ee(z)?"online":null!==(e=z.participants.find((e=>e._id!==(null===Y||void 0===Y?void 0:Y._id))))&&void 0!==e&&e.lastSeen?"last seen ".concat((e=>{const t=new Date,a=new Date(e),s=Math.floor((t.getTime()-a.getTime())/6e4);return s<1?"just now":s<60?"".concat(s,"m ago"):s<1440?"".concat(Math.floor(s/60),"h ago"):a.toLocaleDateString()})(z.participants.find((e=>e._id!==(null===Y||void 0===Y?void 0:Y._id))).lastSeen)):"offline"})]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[z&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("button",{onClick:()=>{},className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",title:"Audio Call",children:(0,w.jsx)(x.A,{size:18})}),(0,w.jsx)("button",{onClick:()=>{},className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",title:"Video Call",children:(0,w.jsx)(g.A,{size:18})})]}),(0,w.jsx)("button",{onClick:()=>a(!1),className:"p-2 hover:bg-green-700 dark:hover:bg-green-600 rounded",title:"Close",children:(0,w.jsx)(u.A,{size:18})})]})]}),(0,w.jsx)("div",{className:"flex-1 overflow-hidden",children:z?(0,w.jsxs)("div",{className:"h-full flex flex-col",children:[(0,w.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 chat-messages",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23e5ddd5' fill-opacity='0.4'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")",backgroundColor:"#e5ddd5"},"data-messages-container":!0,children:[T.map((e=>{const t=e.sender._id===(null===Y||void 0===Y?void 0:Y._id);return(0,w.jsx)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex ".concat(t?"justify-end":"justify-start"," group"),children:(0,w.jsxs)("div",{className:"max-w-xs px-3 py-2 rounded-lg shadow-sm relative ".concat(t?"bg-green-500 text-white":"bg-white text-gray-900"),style:{borderRadius:t?"7.5px 7.5px 7.5px 0px":"7.5px 7.5px 0px 7.5px"},children:[e.replyTo&&(0,w.jsxs)("div",{className:"mb-2 p-2 rounded border-l-4 text-xs ".concat(t?"bg-green-600 border-green-300":"bg-gray-100 border-gray-400"),children:[(0,w.jsx)("p",{className:"font-medium opacity-80",children:e.replyTo.sender.firstName}),(0,w.jsx)("p",{className:"truncate opacity-70",children:e.replyTo.content})]}),e.content&&(0,w.jsx)("p",{className:"text-sm leading-relaxed",children:e.content}),e.media&&e.media.length>0&&(0,w.jsx)("div",{className:"mt-2 space-y-2",children:e.media.map((e=>(0,w.jsx)("div",{children:e.mimetype.startsWith("image/")?(0,w.jsx)("img",{src:e.url,alt:e.originalName,className:"max-w-full h-auto rounded"}):(0,w.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-xs underline",children:[(0,w.jsx)(m.A,{size:12}),(0,w.jsx)("span",{children:e.originalName})]})},e._id)))}),(0,w.jsxs)("div",{className:"flex items-center justify-end mt-1 space-x-1",children:[(0,w.jsx)("span",{className:"text-xs ".concat(t?"text-green-100":"text-gray-500"),children:Q(e.createdAt)}),t&&(0,w.jsx)("div",{className:"text-green-100",children:te(e)})]}),!t&&(0,w.jsx)("button",{onClick:()=>O(e),className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 p-1 bg-gray-200 hover:bg-gray-300 rounded transition-opacity",children:(0,w.jsx)(y.A,{size:12})})]})},e._id)})),R&&(0,w.jsx)("div",{className:"flex justify-start",children:(0,w.jsx)("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:(0,w.jsxs)("div",{className:"flex space-x-1",children:[(0,w.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,w.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,w.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),(0,w.jsx)("div",{ref:G})]}),B&&(0,w.jsx)("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 border-l-4 border-green-500",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("p",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:["Replying to ",B.sender.firstName]}),(0,w.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",children:B.content})]}),(0,w.jsx)("button",{onClick:()=>O(null),className:"text-gray-400 hover:text-gray-600",children:(0,w.jsx)(u.A,{size:16})})]})}),(0,w.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900",children:(0,w.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,w.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,w.jsx)(m.A,{size:20})}),(0,w.jsx)("div",{className:"flex-1 relative",children:(0,w.jsx)("input",{type:"text",value:D,onChange:e=>{U(e.target.value),!I&&e.target.value.trim()?(H(!0),z&&j.z.sendTyping(z._id,!0)):I&&!e.target.value.trim()&&(H(!1),z&&j.z.sendTyping(z._id,!1))},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),Z())},placeholder:"Type a message",className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 dark:text-white"})}),(0,w.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,w.jsx)(b.A,{size:20})}),(0,w.jsx)("button",{onClick:Z,disabled:!D.trim(),className:"p-2 bg-green-500 text-white rounded-full hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,w.jsx)(p.A,{size:18})})]})})]}):(0,w.jsxs)("div",{className:"h-full flex flex-col",children:[(0,w.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900",children:(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,w.jsx)("input",{type:"text",placeholder:"Search or start new chat",value:M,onChange:e=>L(e.target.value),className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 dark:text-white"})]})}),(0,w.jsx)("div",{className:"flex-1 overflow-y-auto",children:P?(0,w.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,w.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):0===ae.length?(0,w.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,w.jsxs)("div",{className:"text-center",children:[(0,w.jsx)(c.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,w.jsx)("p",{children:"No conversations yet"}),(0,w.jsx)("p",{className:"text-sm",children:"Tap the new chat button to start messaging"})]})}):ae.map((e=>{var t;return(0,w.jsx)(i.P.div,{whileHover:{backgroundColor:"rgba(0, 0, 0, 0.05)"},onClick:()=>S(e),className:"p-3 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700",children:(0,w.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)("div",{className:"w-12 h-12 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center text-gray-700 dark:text-gray-300 font-semibold",children:$(e)}),ee(e)&&(0,w.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"})]}),(0,w.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:X(e)}),e.lastMessage&&(0,w.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:Q(e.lastMessage.createdAt)})]}),(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:(null===(t=e.lastMessage)||void 0===t?void 0:t.content)||"Tap to start messaging"}),e.unreadCount>0&&(0,w.jsx)("div",{className:"bg-green-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center ml-2",children:e.unreadCount>99?"99+":e.unreadCount})]})]})]})},e._id)}))})]})})]})})]}):(0,w.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,w.jsx)(i.P.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>J("/signup"),className:"bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg",children:(0,w.jsx)(c.A,{size:24})})})}},9040:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var s=a(2555),r=a(5043),i=a(5487),l=a(3944),n=a(1286),d=a(9333),c=a(2043),o=a(2574),x=a(1884),g=a(9292),u=a(7118),h=a(9482),m=a(8564),y=a(9328),b=a(579);const p=()=>{const[e,t]=(0,r.useState)([]),[a,p]=(0,r.useState)(""),[v,f]=(0,r.useState)(!0),[j,N]=(0,r.useState)(null),[w,k]=(0,r.useState)(1),[C,A]=(0,r.useState)(!0),[_,z]=(0,r.useState)(null),{selectChat:S,loadChats:T}=(0,h.Y)(),E=y.y.getUser(),D=(0,r.useCallback)((async()=>{try{f(!0),N(null);const e=await fetch("http://localhost:5000/api/auth/users?page=".concat(w,"&limit=10&sortBy=createdAt&sortOrder=desc"),{headers:(0,s.A)({"Content-Type":"application/json"},y.y.getAuthHeaders())});if(!e.ok){if(401===e.status)throw y.y.logout(),new Error("Authentication failed. Please login again.");throw new Error("HTTP error! status: ".concat(e.status))}const a=await e.json();let r=[],i=null;if(a&&"object"===typeof a&&(a.success&&a.data?Array.isArray(a.data.users)?(r=a.data.users,i=a.data.pagination):Array.isArray(a.data)&&(r=a.data):Array.isArray(a.users)?(r=a.users,i=a.pagination):Array.isArray(a)&&(r=a)),!Array.isArray(r))throw console.error("Invalid users data received:",a),new Error("Invalid response format from server");const l=r.filter((e=>e&&"object"===typeof e&&e._id?e._id!==(null===E||void 0===E?void 0:E._id):(console.warn("Invalid user object:",e),!1)));t(1===w?l:e=>[...e,...l]),A(i&&"object"===typeof i?!0===i.hasNext:10===l.length)}catch(j){console.error("Failed to load contacts:",j),N(j instanceof Error?j.message:"Failed to load contacts")}finally{f(!1)}}),[w,null===E||void 0===E?void 0:E._id]);(0,r.useEffect)((()=>{D()}),[D]);const U=e.filter((e=>{if(!e||"object"!==typeof e)return!1;const t=String(e.firstName||""),s=String(e.lastName||""),r=String(e.email||""),i="".concat(t," ").concat(s).toLowerCase(),l=a.toLowerCase();return i.includes(l)||r.toLowerCase().includes(l)})),M=U.filter((e=>e.isFavorite)),L=U.filter((e=>!e.isFavorite)),P=e=>{if(!e)return"Never";try{const t=new Date,a=new Date(e),s=Math.floor((t.getTime()-a.getTime())/6e4);return s<1?"just now":s<60?"".concat(s,"m ago"):s<1440?"".concat(Math.floor(s/60),"h ago"):a.toLocaleDateString()}catch(j){return"Unknown"}},F=e=>{let{contact:t}=e;if(!t||"object"!==typeof t||!t._id)return null;const a=String(t.firstName||"Unknown"),s=String(t.lastName||"User"),r=String(t.email||"No email"),x="".concat(a," ").concat(s),g="".concat(a.charAt(0)).concat(s.charAt(0)).toUpperCase();return(0,b.jsx)(i.P.div,{whileHover:{backgroundColor:"rgba(59, 130, 246, 0.05)"},className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer border-b border-gray-100 dark:border-gray-700",children:(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold",children:g}),t.isOnline&&(0,b.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-900"}),t.isFavorite&&(0,b.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center",children:(0,b.jsx)(l.A,{size:10,className:"text-white fill-current"})})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:x}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("button",{className:"p-1 text-gray-400 hover:text-green-600 rounded transition-colors",title:"Voice Call",onClick:e=>{e.stopPropagation()},children:(0,b.jsx)(n.A,{size:16})}),(0,b.jsx)("button",{className:"p-1 text-gray-400 hover:text-blue-600 rounded transition-colors",title:"Video Call",onClick:e=>{e.stopPropagation()},children:(0,b.jsx)(d.A,{size:16})}),(0,b.jsx)("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(_!==e._id)try{z(e._id),N(null);const t=await m.O.createIndividualChat(e._id);if(!t.success||!t.data)throw new Error(t.message||"Failed to create chat");await T(),S(t.data)}catch(j){console.error("Failed to start chat:",j),N(j instanceof Error?j.message:"Failed to start chat")}finally{z(null)}})(t)},disabled:_===t._id,className:"p-1 text-gray-400 hover:text-blue-600 rounded transition-colors disabled:opacity-50",title:"Start Chat",children:_===t._id?(0,b.jsx)(c.A,{size:16,className:"animate-spin"}):(0,b.jsx)(o.A,{size:16})})]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:r}),(0,b.jsx)("p",{className:"text-xs text-gray-400",children:t.isOnline?"Online":"Last seen ".concat(P(t.lastSeen))})]})]})})};return(0,b.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Contacts"}),(0,b.jsx)("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,b.jsx)(x.A,{size:20})})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),(0,b.jsx)("input",{type:"text",placeholder:"Search contacts...",value:a,onChange:e=>p(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-800 border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"})]})]}),j&&(0,b.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500",children:[(0,b.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400",children:j}),(0,b.jsx)("button",{onClick:()=>{N(null),k(1),D()},className:"text-sm text-red-600 dark:text-red-400 hover:underline mt-1",children:"Try again"})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:v&&1===w?(0,b.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Loading contacts..."})]})}):(0,b.jsxs)(b.Fragment,{children:[M.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,b.jsxs)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[(0,b.jsx)(l.A,{size:16,className:"mr-2 text-yellow-500"}),"Favorites (",M.length,")"]})}),M.map((e=>(0,b.jsx)(F,{contact:e},e._id)))]}),L.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800",children:(0,b.jsxs)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[(0,b.jsx)(u.A,{size:16,className:"mr-2"}),"All Contacts (",L.length,")"]})}),L.map((e=>(0,b.jsx)(F,{contact:e},e._id)))]}),C&&!v&&L.length>0&&(0,b.jsx)("div",{className:"p-4",children:(0,b.jsx)("button",{onClick:()=>{!v&&C&&k((e=>e+1))},className:"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Load More Contacts"})}),v&&w>1&&(0,b.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,b.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"Loading more..."})]}),0===U.length&&!v&&!j&&(0,b.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(u.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{className:"font-medium",children:"No contacts found"}),(0,b.jsx)("p",{className:"text-sm",children:a?"Try adjusting your search terms":"No users available to connect with"}),!a&&(0,b.jsx)("button",{onClick:()=>{k(1),D()},className:"mt-2 text-blue-600 hover:text-blue-800 text-sm",children:"Refresh contacts"})]})})]})})]})}}}]);
//# sourceMappingURL=648.58657759.chunk.js.map